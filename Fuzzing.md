thay vì gửi giá trị id = 1 hacker sẽ gửi giá trị id = .-1 or 1=1. URL http://example.com/ex1/injection/user.php?id=-1or1=1 Khi đó câu truy vấn sẽ trở thành: SQL Query.SELECT * FROM users WHERE userID=-1 or 1=1 Rõ ràng với điều kiện WHERE userID = -1 thì CSDL sẽ không trả về bản ghi nào trả về. Tuy nhiên, nếu chèn vào đoạn mã "or 1=1 " thì điều kiện sau WHERE sẽ trở nên luôn đúng và kết quả là CSDL sẽ trả về tất cả các bản ghi có trong bảng users. Bằng những cách thức nâng cao khác, hacker hoàn toàn có thể chèn các đoạn mã nguy hiểm hơn để lấy toàn bộ thông tin về hệ thống, đọc ghi tệp tin bằng các hàm trong CSDL như: outfile, load_file (MySQL), execute (MSSQL) lên hệ thống từ đó hình thành những backdoor và sau cùng là chiếm quyền điều khiển toàn bộ hệ thống. Với kiểu tấn công Xpath Injection ta cũng có thể khai thác hoàn toàn tương tự. Mức độ nguy hiểm của SQL/Xpath Injection là rất cao bởi vì nó tác động trực tiếp đến CSDL: ăn cắp thông tin người dùng, thay đổi làm sai lệch các thông tin quan trọng, thêm sửa xóa CSDL… Với hệ thống website đặc biệt là các hệ thống có liên quan đến tài chính như ngân hàng, thì việc thông tin bị đánh cắp hay thay đổi sẽ gây những thiệt hại vô cùng lớn. 1.3. Cơ chế phát hiện Có thể phát hiện các lỗi SQL/Xpath Injection bằng 4 phương pháp chính:
Dựa trên các thông báo lỗi từ hệ thống, từ CSDL của hệ thống.
Dựa trên kỹ thuật boolean based (kiểm tra kết quả khác nhau của các câu truy vấn khác nhau, ví dụ như khi chèn or 1=1 và or 1=2).
Dựa trên kỹ thuật nối câu truy vấn (UNION query).
Dựa trên kỹ thuật timebased: sử dụng các hàm thao tác với thời gian trong hệ quản trị CSDL và kiểm tra timeout của kết quả trả về. Bộ dữ liệu fuzzing sẽ thiết kế dựa trên các kỹ thuật phát hiện này.
Đoạn mã PHP:. <?php. if (isset( _GET[&apos;msg&apos;] ) ){.echo &apos;&lt;h1&gt;&apos;._GET['msg'].'</h1>';. } .?>. Tuy nhiên một hacker thay vì việc nhập vào dữ liệu hợp lệ có thể nhập vào những thẻ HTML và mã Javascript ví dụ như: http://fuzzing.vn:8001/Vulns/XSS/example.php?.msg=<script>alert(document.cookie)</scsript> 
Đế phát hiện lỗi này chúng ta sẽ thực hiện tạo fuzzer gửi một chữ ký kèm những đoạn mã đặc biệt tới hệ thống như: .<scipt>alert(1223)</script>.“><scipt>alert(1223)</script>.“ onmouseover=alert(123445) foo=”
Để phát hiện lỗi này chúng ta sẽ thực hiện đưa vào những giá trị của các tệp tin có thể và kiểm tra kết quả trả về để đánh giá việc tồn tại của lỗ hổng. Ví dụ:. / / /etc/passwd.- / / /etc/shadow.- / /apache/logs/access.log. Việc chèn số các “ /” là do chương trình phát hiện sẽ tự động thêm vào.

![305966405_831544691208113_6765267647051335438_n](https://github.com/NguyenNhutY/Computer_Networks/assets/130396826/25c08c0f-cad0-4ae1-85c5-4f5ed1f27da0)
![307675093_831544594541456_4646362144844266861_n](https://github.com/NguyenNhutY/Computer_Networks/assets/130396826/b74b8892-d733-4cdf-ab68-4aa8b11128e4)
